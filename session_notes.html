<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 5.2.0 (401472)"/><meta name="altitude" content="1626.5810546875"/><meta name="author" content="Jerry Gulla"/><meta name="created" content="2013-07-18 15:15:38 +0000"/><meta name="latitude" content="39.89052485076909"/><meta name="longitude" content="-105.065607174418"/><meta name="updated" content="2013-07-18 15:24:26 +0000"/><title>Session Notes</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
<div><b>Install &amp; Setup</b><br/></div>
<div><b>===========<br/></b>
<div>tar zxf elasticsearch-0.90.2.tar.gz</div>
<div>cd elasticsearch-0.90.2/</div>
<div>./bin/elasticsearch -f</div>
<div><br/></div>
<div><b>RestClient</b></div>
<div><b>========</b></div>
<div># Some query examples use RESTClient, an open source Java tool to work with REST APIs</div>
<div># Download at <a href="https://code.google.com/p/rest-client/">https://code.google.com/p/rest-client/</a></div>
<div># Examples are in rcq folder </div>
<div><br/></div>
<div># Does it work?</div>
<div>curl -XGET '<a href="http://localhost:9200">http://localhost:9200</a>'<br/></div>
<div><br/></div>
<div><br/></div>
<div><b>Adding Data</b></div>
<div><b>==========</b></div>
</div>
<div><br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1">http://localhost:9200/minecraft/mob/1</a> -d '{ "name" : "creeper", "friendly" : "false" }'<br/></div>
<div><br/></div>
<div>#Add one tweet, show URL breakdown</div>
<div><br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/2</a> -d '{ "name" : "zombie", "friendly" : "false" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/2</a> -d '{ "name" : "spider", "friendly" : "false" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/4</a> -d '{ "name" : "villager", "friendly" : "true" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/</a>5 -d '{ "name" : "chicken", "friendly" : "true" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/</a>6 -d '{ "name" : "cow", "friendly" : "true" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7 -d '{ "name" : "baby zombie", "friendly" : "false" }'<br/></div>
<div><br/></div>
<div>
<div><b>Retrieving Data</b></div>
<div><b>============</b></div>
</div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/1?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/2?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/3?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/4?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/5?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/6?pretty=true</a><br/></div>
<div>curl -XGET <a href="http://localhost:9200/uberconf/tweet/10?pretty=true">http://localhost:9200/minecraft/mob/7?pretty=true</a><br/></div>
<div><br/></div>
<div><b>Deleting Data</b><br/></div>
<div><b>============</b></div>
<div>#add bogus data</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/</a>8 -d '{ "name" : "cat", "friendly" : "true" }'<br/></div>
<div><br/></div>
<div># get it</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/mob/7">http://localhost:9200/minecraft/mob/</a>8?pretty'<br/></div>
<div><br/></div>
<div># delete it</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/mob/7">http://localhost:9200/minecraft/mob/</a>8?pretty'<br/></div>
<div><br/></div>
<div># get it</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/mob/7">http://localhost:9200/minecraft/mob/</a>8?pretty'<br/></div>
<div><br/></div>
<div>
<div><b>Search</b></div>
<div><b>=====</b></div>
</div>
<div>#get everything</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/mob/_search?pretty">http://localhost:9200/minecraft/mob/_search?pretty</a>'<br/></div>
<div><br/></div>
<div>#get one thing</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob/_search?q=name:creeper&amp;pretty'</div>
<div><br/></div>
<div>#get multiple things</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob/_search?q=friendly:true&amp;pretty'</div>
<div> </div>
<div>
<div><b>Updating Data</b></div>
<div><b>===========</b></div>
</div>
<div>curl -XPUT <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/mob/1?pretty</a> -d '{ "name" : "creeper", "friendly" : "false", "rare" : "false", "valuable" : "false" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/2</a> -d '{ "name" : "zombie", "friendly" : "false", "rare" : "true", "valuable" : "false"  }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/2</a> -d '{ "name" : "spider", "friendly" : "false", "rare" : "true", "valuable" : "false"  }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/4</a> -d '{ "name" : "villager", "friendly" : "true", "rare" : "true", "valuable" : "false"  }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/</a>5 -d '{ "name" : "chicken", "friendly" : "true", "rare" : "true", "valuable" : "true"  }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/4">http://localhost:9200/minecraft/mob/</a>6 -d '{ "name" : "cow", "friendly" : "true", "rare" : "false", "valuable" : "true"  }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7 -d '{ "name" : "baby zombie", "friendly" : "false", "rare" : "true", "valuable" : "false" }'</div>
<div><br/></div>
<div># update in place</div>
<div>curl -POST '<a href="http://localhost:9200/minecraft/mob/1/_update?pretty">http://localhost:9200/minecraft/mob/1/_update?pretty</a>' -d ' {"script": "ctx._source.rare=false"}'<br/></div>
<div><br/></div>
<div>#Can't add new fields</div>
<div>curl -XPOST '<a href="http://localhost:9200/minecraft/mob/1/_update?pretty">http://localhost:9200/minecraft/mob/1/_update?pretty</a>' -d ' {"script": "ctx._source.newfield=test"}'<br/></div>
<div><br/></div>
<div>
<div>
<div># Create a conflict</div>
<div>#first update a few times</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7 -d '{ "name" : "baby zombie", "friendly" : "false", "rare" : "true", "valuable" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7?version=2 -d '{ "name" : "baby zombie", "friendly" : "false", "rare" : "true", "valuable" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7?version=2 -d '{ "name" : "baby zombie", "friendly" : "false", "rare" : "true", "valuable" : "false" }'</div>
<div><br/></div>
<div># try and post an old version</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/2">http://localhost:9200/minecraft/mob/</a>7?version=2 -d '{ "name" : "baby zombie", "friendly" : "false", "rare" : "true", "valuable" : "false" }'</div>
<div><br/></div>
<div><b>Paging Through Results</b></div>
<div><b>===================</b><br/></div>
</div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=1&amp;pretty' <b><br/></b></div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=3&amp;pretty' <b><br/></b></div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=50&amp;pretty' <b><br/></b></div>
<div><b><br/></b></div>
<div>#start point</div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=3&amp;from=0&amp;pretty' <b><br/></b></div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=3&amp;from=1&amp;pretty' <b><br/></b></div>
<div>curl -XGET 'http://localhost:9200/minecraft/_search?size=3&amp;from=2&amp;pretty' <b><br/></b></div>
<div><br/></div>
<div># counting</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/mob/_count?pretty">http://localhost:9200/minecraft/mob/_count?pretty</a>'<br/></div>
<div><br/></div>
<div><b><br/></b></div>
<div><b>Multiple Indicies</b></div>
<div><b>=============</b></div>
</div>
<div># Minecraft is more than mobs. It's about blocks! </div>
<div><br/></div>
<div>#Next one won't work - need an ID</div>
<div>curl --XPUT <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block?pretty</a> -d '{ "name" : "cobblestone", "rare" : "false", "valuable" : "false" }'<br/></div>
<div><br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/1?pretty</a> -d '{ "name" : "cobblestone", "rare" : "false", "valuable" : "false", "nether" : "false" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/2?pretty</a> -d '{ "name" : "gravel", "rare" : "false", "valuable" : "false", "nether" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/3?pretty</a> -d '{ "name" : "netherack", "rare" : "false", "valuable" : "false", "nether" : "true" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/4?pretty</a> -d '{ "name" : "diamond", "rare" : "true", "valuable" : "true", "nether" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/5?pretty</a> -d '{ "name" : "gold", "rare" : "true", "valuable" : "true", "nether" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/6?pretty</a> -d '{ "name" : "coal", "rare" : "true", "valuable" : "true", "nether" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/7?pretty</a> -d '{ "name" : "sand", "rare" : "false", "valuable" : "false", "nether" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/block/8?pretty</a> -d '{ "name" : "redstone", "rare" : "false", "valuable" : "true", "nether" : "false" }'</div>
<div><br/></div>
<div><br/></div>
<div># search multiple indices</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob,block/_search?q=rare:true&amp;pretty'</div>
<div><br/></div>
<div>#get just the count</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob,block/_count?q=rare:true&amp;pretty'</div>
<div><br/></div>
<div># Search at a higher level (across all indicies)</div>
<div>curl -GET 'http://localhost:9200/minecraft/_search?q=rare:true&amp;pretty' </div>
<div><br/></div>
<div># Add items</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/1?pretty</a> -d '{ "name" : "string", "rare" : "true", "valuable" : "true", "crafted" : "false" }'<br/></div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/2?pretty</a> -d '{ "name" : "shovel", "rare" : "false", "valuable" : "true", "crafted" : "true" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/3?pretty</a> -d '{ "name" : "pickaxe", "rare" : "false", "valuable" : "true", "crafted" : "true" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/4?pretty</a> -d '{ "name" : "bonemeal", "rare" : "false", "valuable" : "true", "crafted" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/5?pretty</a> -d '{ "name" : "torch", "rare" : "false", "valuable" : "true", "crafted" : "true" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/6?pretty</a> -d '{ "name" : "flint", "rare" : "true", "valuable" : "true", "crafted" : "false" }'</div>
<div>curl -XPOST <a href="http://localhost:9200/minecraft/mob/1?pretty">http://localhost:9200/minecraft/item/7?pretty</a> -d '{ "name" : "chest", "rare" : "false", "valuable" : "true", "crafted" : "true" }'</div>
<div><br/></div>
<div># search multiple indices</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob,block,item/_search?q=rare:true&amp;pretty'</div>
<div><br/></div>
<div>#get just the count</div>
<div>curl -XGET 'http://localhost:9200/minecraft/mob,block,item/_count?q=rare:true&amp;pretty'</div>
<div><br/></div>
<div># Search at a higher level (across all indicies)</div>
<div>curl -GET 'http://localhost:9200/minecraft/_search?q=rare:true&amp;pretty' </div>
<div><br/></div>
<div>#change around which index to use, see differences</div>
<div><br/></div>
<div>
<div><b>Mappings</b></div>
<div><b>========</b></div>
</div>
<div># Now create an inventory so we can have a count</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/1</a> -d '{ "item" : "pickaxe", "quantity" : 1, "enchanted" : "false } '<br/></div>
<div><br/></div>
<div># Get mapping</div>
<div>curl -XGET '<a href="http://localhost:9200/minecraft/inventory/_mapping?pretty">http://localhost:9200/minecraft/inventory/_mapping?pretty</a>'<br/></div>
<div># notice enchanted is a string</div>
<div>#can't change fields</div>
<div>!<br/></div>
<div>#start over. delete index</div>
<div>curl -XDELETE '<a href="http://localhost:9200/minecraft/inventory">http://localhost:9200/minecraft/inventory</a>'<br/></div>
<div><br/></div>
<div>#Now re-add data</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/1</a> -d '{ "item" : "pickaxe", "quantity" : 1, "enchanted" : false, "player" : "nicholas" } '<br/></div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>2 -d '{ "item" : "shovel", "quantity" : 1, "enchanted" : false, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>3 -d '{ "item" : "sword", "quantity" : 1, "enchanted" : true, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>4 -d '{ "item" : "coal", "quantity" : 55, "enchanted" : false, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>5 -d '{ "item" : "redstone", "quantity" : 21, "enchanted" : false, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>6 -d '{ "item" : "diamond", "quantity" : 17, "enchanted" : false, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>7 -d '{ "item" : "iron", "quantity" : 47, "enchanted" : false, "player" : "nicholas" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>8 -d '{ "item" : "pickaxe", "quantity" : 1, "enchanted" : false, "player" : "dad" } '<br/></div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>9 -d '{ "item" : "coal", "quantity" : 4, "enchanted" : false, "player" : "dad" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>10 -d '{ "item" : "diamond", "quantity" : 0, "enchanted" : false, "player" : "dad" } '</div>
<div>curl -POST <a href="http://localhost:9200/minecraft/inventory/1">http://localhost:9200/minecraft/inventory/</a>11 -d '{ "item" : "sword", "quantity" : 1, "enchanted" : false, "player" : "dad" } '</div>
<div><br/></div>
<div># What does nick have?</div>
<div>curl -XGET 'http://localhost:9200/minecraft/inventory/_search?q=player:nicholas&amp;pretty'</div>
<div> </div>
<div>#what does dad have?</div>
<div>curl -XGET 'http://localhost:9200/minecraft/inventory/_search?q=player:dad&amp;pretty'</div>
<div> </div>
<div># Who has diamonds?</div>
<div>curl -XGET 'http://localhost:9200/minecraft/inventory/_search?q=item:diamond&amp;pretty' </div>
<div><br/></div>
<div><b>Filters &amp; Queries</b></div>
<div><b>=============</b></div>
<div>#Load up with RestClient<b>   </b></div>
<div><b><br/></b></div>
<div>search_inv_all.rcq</div>
<div>search_field_req.rcq</div>
<div>search_range_req.rcq</div>
<div>search_filter_and_query.rcq # play w/ searching for different items</div>
<div><br/></div>
<div><b>Clustering</b></div>
<div>./bin/elasticsearch -f</div>
<div> <a href="http://localhost:9200/_cluster/health?pretty">http://localhost:9200/_cluster/health?pretty</a></div>
<div><br/></div>
<div>#next tab</div>
<div>./bin/elasticsearch -f</div>
<div> <a href="http://localhost:9200/_cluster/health?pretty">http://localhost:9200/_cluster/health?pretty</a></div>
<div><br/></div>
<div>#Then kill one</div>
<div> </div>
<div><br/></div>
<div><b>More Queries</b></div>
<div><b>========== </b></div>
<div>#Load up with RestClient <b>  </b></div>
<div>Enchanted Pickaxe: search_multi_field_query_and_enchanted.rcq</div>
<div><br/></div>
<div>search_query_and_range.rcq</div>
<div>search_multi_field_query.rcq</div>
<div>search_multi_field_query_and.rcq</div>
<div>search_multi_field_query_and_enchanted.rcq</div>
<div><br/></div>
<div>#find enchanted sword, bool format     </div>
<div>search_multi_field_query_item_and_player_bool.rcq</div>
<div><br/></div>
<div># Also by player (3 search terms)</div>
<div>search_multi_field_query_item_and_enchanted_and_player_bool.rcq</div>
<div><br/></div>
<div><br/></div>
<div><b>Plugins</b></div>
<div><b>======</b></div>
<div>#Site plugin.</div>
<div>cd ./elasticsearch-head</div>
<div>open index.html</div>
<div><br/></div>
<div>#GREAT place to help build queries! go to query tab</div>
<div><a href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a><br/></div>
<div><br/></div>
<div> #elasticHQ</div>
<div><a href="http://www.elastichq.org/gettingstarted.html">http://www.elastichq.org/gettingstarted.html</a><br/></div>
<div>unzip royrusso-elasticsearch-HQ-7d52c5d.zip # (note filename may change)</div>
<div>cd ./elasticsearch-head/royrusso-elasticsearch-HQ-7d52c5d</div>
<div>open index.html</div>
<div><br/></div>
<div>#connect to http://localhost:9200 (top of page)</div>
</body></html>